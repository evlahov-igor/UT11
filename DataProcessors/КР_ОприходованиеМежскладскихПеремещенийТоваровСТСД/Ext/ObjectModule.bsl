
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Возвращает сведения о внешней обработке
//
// Возвращаемое значение:
//	Структура - структура сведений о внешней обработке
//
Функция СведенияОВнешнейОбработке() Экспорт
	
	ПараметрыОбработки = ПолучитьПараметрыОбработки();
	
	ПараметрыРегистрации = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке("2.2.2.1");
	ПараметрыРегистрации.БезопасныйРежим = Ложь;
	ПараметрыРегистрации.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительнаяОбработка();
	ПараметрыРегистрации.Версия = ПараметрыОбработки.Версия;
	ПараметрыРегистрации.Наименование = ПараметрыОбработки.Наименование;
	
	НоваяКоманда = ПараметрыРегистрации.Команды.Добавить();
	НоваяКоманда.Представление = ПараметрыОбработки.Наименование;
	НоваяКоманда.Идентификатор = ПараметрыОбработки.ИмяОбработки;
	НоваяКоманда.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыОткрытиеФормы();
	НоваяКоманда.ПоказыватьОповещение = Ложь;
	
	Возврат ПараметрыРегистрации;
	
КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Функция ПолучитьПараметрыОбработки()
	
	МДОбработки = ЭтотОбъект.Метаданные();
	ИмяОбработки = МДОбработки.ПолноеИмя();
	СинонимОбработки = МДОбработки.Представление();
	
	МассивСтрок = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(ИмяОбработки, "_v", Истина, Истина);
	Если МассивСтрок.Количество() = 2 Тогда
		Версия = СтрЗаменить(МассивСтрок[1], "_", ".");
	Иначе	
		Версия = "1.0";
	КонецЕсли;
	
	СтруктураПараметров = Новый Структура;
	СтруктураПараметров.Вставить("Версия", Версия);
	СтруктураПараметров.Вставить("Наименование", СинонимОбработки);
	СтруктураПараметров.Вставить("ИмяОбработки", ИмяОбработки);
	
	Возврат СтруктураПараметров;
	
КонецФункции

#КонецОбласти

#КонецЕсли