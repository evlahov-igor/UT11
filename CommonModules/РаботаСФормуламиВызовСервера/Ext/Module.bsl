
#Область ПрограммныйИнтерфейс

// Функция значение параметра по имени
//
// Параметры:
//   ТекстРасчета - Строка - вычисляемая формула
//   ЗначениеЗамены - Произвольный - параметр, для которого будет вычисляться формула.
//
// Возвращаемое значение:
//   Произвольный.
//
Функция ПроверитьФормулуЗапроса(ТекстРасчета, ЗначениеЗамены) Экспорт
	
	
	Запрос = Новый Запрос();
	Запрос.Текст = СтрЗаменить("ВЫБРАТЬ ПолеШаблон ИЗ ТаблицаШаблон","ПолеШаблон ИЗ ТаблицаШаблон",СтрЗаменить(ТекстРасчета, Строка(ЗначениеЗамены), "&Параметр"));
	Запрос.УстановитьПараметр("Параметр", ЗначениеЗамены);
	Выборка = Запрос.Выполнить().Выбрать();
	Выборка.Следующий();
	
	Возврат Выборка.Получить(0);
	
КонецФункции

// Процедура получения текста запроса
//
// Параметры:
//   ТекстРасчета   - Строка - вычисляемая формула
//   Операнды       - Массив - массив операндов
//   ЗначениеЗамены - Произвольный - параметр, для которого будет вычисляться формула.
//
Процедура ПолучитьТекстРасчета(ТекстРасчета, Операнды, ЗначениеЗамены) Экспорт
	
	ГСЧ = Новый ГенераторСлучайныхЧисел();
	Для Каждого Операнд Из Операнды Цикл
		ЗначениеДляПодстановки = ЗначениеЗамены;
		Если ЗначениеЗамены = "1 " Тогда
			СлучайноеЧисло = ГСЧ.СлучайноеЧисло(1, 1000);
			ЗначениеДляПодстановки = Строка(СлучайноеЧисло + " ");
		КонецЕсли;
		ТекстРасчета = СтрЗаменить(ТекстРасчета, РаботаСФормуламиКлиентСервер.ПолучитьТекстОперандаДляВставки(Операнд), ЗначениеДляПодстановки);
	КонецЦикла;

КонецПроцедуры

#КонецОбласти

